<script>
document.addEventListener('DOMContentLoaded', function() {

    console.log('it is running');
    var adElements = document.querySelectorAll('.side-bar-ad-slot');
    let counter = 0;

    // Give unique ids to sidebar ad elements 
    adElements.forEach(function(adElement) {
        adElement.id = 'side-gam-ad-' + counter;
        counter++;  // Increment the counter for the next ad element
    });
    
    window.googletag = window.googletag || {cmd: []};
    googletag.cmd.push(function() {

        // Define side ads
        adElements.forEach(function(adElement) {
            googletag.defineSlot('/23075930536/post-side', [300, 600], adElement.id)
                     .addService(googletag.pubads());
        });

        // Define bottom ad
        googletag.defineSlot('/23075930536/post-bottom', ['fluid'], 'gam-ad-bottom').addService(googletag.pubads());

        // Enable lazy loading with default settings.
        googletag.pubads().enableLazyLoad();

        googletag.pubads().addEventListener("slotRequested", (event) => {
            console.log(`Slot ${event.slot.getSlotElementId()} fetched`);
        });

        googletag.pubads().addEventListener("slotOnload", (event) => {
            console.log(`Slot ${event.slot.getSlotElementId()} rendered`);
        });

        googletag.pubads().enableSingleRequest();
        googletag.enableServices();


        // Display all ad slots to trigger lazy loading
        if (adElements.length > 0) {
            googletag.display(adElements[0].id);
        }
    });
});
</script>
